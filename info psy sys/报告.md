### **基于开放类别分类的信息物理系统异常检测算法**
- 研究内容
	在现实的信息物理系统异常检测任务中，分类器有可能遇到不属于训练集中任何已知类别的数据，例如信息系统遭受新型网络攻击，物理系统出现异常工况等。妥善处理此等“前所未见”的数据对于系统的安全防护至关重要，而传统分类器对此往往无能无力。本项目因此**研究开放类别分类（open-category classification）问题**：待分类的数据中存在某些类别，分类器在训练阶段没有观察到它们的实例，但在预测阶段可能遇到它们的实例。具体而言，假设用于训练分类器的数据集为![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png)，其中的样本![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png)，对应的类别标签![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png)。在测试阶段，分类器需要对一个开放集合中的数据给出类别标签，即![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image009.png)，其中![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image012.png)。开放类别分类寻求一个从样本实例到类别标签映射，即![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image014.png)，其中的![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image016.png)代表在训练数据集中从未出现过的类别，对应于信息物理系统受到的未知攻击和不明原因的异常状态。
	
	开放类别分类问题难以直接解决，一是由于缺少属于“未知类别”的训练数据；二是因为“未知类别”属于语义概念，没有明确的生成规则可循。一个可行的方案是，参考已知类别的数据来生成未知类别的数据并将其放入原训练集，得到增强训练集，原问题即转化为在增强训练集上的监督学习。因此，**研究“未知类别”的数据生成，此中的一个重要问题是对已知类别数据的空间体量（volume）的保守刻画。**举例而言，一个用于信息物理系统入侵检测的“正常/异常”分类器会将样本空间一分为二，从而能以较优的方式分开两类数据。但当以识别“未知类别”数据为目的时，这种分割方式显然是不恰当的：其用于包裹已知类别数据的空间体量过于宽大了，从而增大了“未知类别”数据样本落入其中的可能性。相较之下，开放类别分类器也会对样本空间进行划分，但会在保证一定泛化能力的前提下促使正常数据所占的空间尽可能的紧凑，体现出所谓的保守性（conservatism）。**本项目将对与开放类别分类器相关的空间体量刻画、目标函数构建、优化问题求解等开展研究。**
	
	鉴于以生成对抗网络为代表的生成式模型在数据增强方面的良好表现，**本项目还将开展基于生成式模型的开放类别分类器研究。**通过在已知类别样本的边界附近生成未知类别样本，引导分类器学习鉴别已知与未知数据，从而在预测阶段能够更好的识别未知类别样本。

观察到深度学习模型在图像分类任务和文本分类中对
来自不同语义分布的样本进行分类时往往不合适，但
实际上过于自信(Hendrycks & Gimpel, 2017)，于是出
现了分布外检测领域，要求模型拒绝与训练分布在语
义上不同的输入，因此不应该被模型预测。
分布外检测，或称OOD检测，其目的是检测从不同于
训练分布的分布中抽取的测试样本，分布的定义根据
目标中的应用来定义。对于大多数机器学习任务，分
布应该参考“标签分布”，这意味着OOD样本不应该
与训练数据有重叠的标签。形式上，在OOD检测中，
测试样本来自语义从ID转移的分布，即P(Y)= P(Y)。请
注意，训练集通常包含多个类，OOD检测应NOT损害
ID分类能力。
在常见的机器学习任务中，分布外检测可以规范于
OSR，如多类分类——保持对ID类空间Y的测试样本
的分类性能，并拒绝语义不支持Y的OOD测试样本。多
类设置和ID分类的要求将该任务与AD和ND区分开来。
OOD检测的应用通常是在安全关键的情况下，比如自
动驾驶(Huang et al.， 2020b;Geiger et al.， 2012)。在
自动驾驶汽车的背景下，OOD检测(也称为OSR)在识
别新的或意外的物体和场景方面起着至关重要的作用，
使系统能够采取适当的行动来确保乘客和行人的安全。
其他潜在的实际应用包括医疗诊断，其中OOD检测可
以帮助标记可能需要医疗保健专业人员进一步关注的
异常患者病例，以及工业监测。 

ood -> 进一步关注新的异常类型
ood -> 假设检验
osr -> 需要一个性能好的闭集分类器
在现实的信息物理系统异常检测任务中，分类器有可能遇到不属于训练集中任何已知类别的数据，例如信息系统遭受新型网络攻击，物理系统出现异常工况等。妥善处理此等“前所未见”的数据对于系统的安全防护至关重要，而传统分类器对此往往无能无力。因此，需要研究识别这类“前所未见”的数据的分类方法。
一般的，这种分类方法被称为开集识别问题（Open Set Recognition，OSR）。而在训练集中未出现的数据被称为分布外（Out-of-Distribution）数据。分类器的前提假设是系统的正常运作数据服从某种分布，称为分布内（In Distribution）样本。而异常数据总是不服从这种分布，即分布外数据。开集识别问题可以建模为一个单样本假设检验问题。对于给定样本$x$，检验决定是否拒绝样本来自训练集的分布P的零假设：
$$
\begin{align}
&H_0 : x\sim P \newline
&H_A : s\sim Q\in\mathbb{Q}， P\notin\mathbb{Q}
\end{align}
$$
于异常行为的数据相较于正常行为存在分布转移。分布转移分为协变量转移和语义转移两类，对于信息物理系统的异常检测任务，均有研究的价值。两类分布转移分别对应两类异常：低级感官异常和高级语义异常。具体而言，对于来自$P(X)$的样本，对应标签分布$P(Y)$，低级感官异常对应的样本来自于分布$P'(X), P'(X)\neq P(X)$；高级语义异常的标签分布为$P'(Y), P'(Y)\neq P(Y)$。
对于一个开集分类器，面对开集分类问题为了提高其泛化能力，可以从数据预处理、分类器模型和样本评估指标三方面得到提升。在数据输入阶段，通过特征提取、数据重建等方式，扩大分布内样本和分布外样本的差异；或采用数据增强的方式处理训练数据集。在模型设计阶段，优化神经网络模型，增大分布内样本和分布外样本的表征差异。在结果输出阶段，设计有效的评估指标，区分不同样本。



传统的模式识别系统通常基于三个假设：封闭世界假设，训练测试域数据独立同分布与各类别数据量充足假设。在现实的开放世界环境中，这些模式识别系统可能不稳定并且不可靠，这种鲁棒性问题掣肘相关技术的进一步发展与应用。现实世界环境中较为常见的问题包括测试标签分布来自训练标签分布以外，这种任务被称作OOD Detection（Out-of-Distribution Detection）。OOD检测的挑战主要源于：现代深度神经网络很容易对分布外样本产​​生过度自信的预测，简单的通过模型置信度或者预测输出很难判别分布外样本。这就需要对模型设计分布外程度的评判方法，辅助模型判断样本是否属于分布外样本。



### 研究适用于信息物理系统异常检测任务的开放类别分类方法

- 研究目标 - （2）
	解决数据样本最小化空间体量的表征和学习、非凸函数优化等问题，从生成式和判别式两种模型的角度出发设计可识别未知攻击的入侵检测算法，使用所搭建的安全测试平台进行比较验证。

### 开放类别分类器

- 研究方案 - （2）

	**构建开放类别分类器的关键是以一种保守的方式刻画已知数据样本的空间体量（volume）。**理想的空间体量除包含大多数的已知样本外，还能将与已知样本类似的未知数据纳入其内，兼顾紧凑和泛化能力，同时不过于复杂。**一种可行的方案是构建一个可以描述已知类别数据占整个输入空间比例的函数，将其作为惩罚项纳入模型训练的优化目标之中。**用![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png)代表此函数，对于数据样本![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png)，给定损失函数![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image006.png)，模型参数![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)，分类器![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image010.png)，用于惩罚复杂度的正则项![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image012.png)，以及参数![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image014.png)和![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image016.png)，优化目标可设置为![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image018.png)。将此目标函数作用于已知类别的训练数据之上，随着越来越多的已知样本被加入，损失函数![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image006.png)会促使由模型参数![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)表示的空间边界扩展到包含所有已知样本，同时![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image020.png)和![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image022.png)通过阻止过度泛化来促使空间保持紧致。在测试和预测阶段，可以将与学习得到的空间体量过远的样本判别为“未知类别”,也即针对信息物理系统的未知攻击。
	
	本项目将针对如何构建惩罚项![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image023.png)以促进样本空间紧致这一问题开展深入研究。**一种可行的方案是将单分类支持向量机中的支持向量数据描述（Support Vector Data Description，SVDD）方法与进行表征学习的深度神经网络相结合**，**在寻求数据样本的最小化空间体量的同时学习其压缩表征。**如图5所示，SVDD的训练过程旨在寻找高维空间中的一个超球面，以最小的半径将训练集中的数据包裹起来。待测数据映射到高维空间后，如果落在这个超球面内，则认定其属于目标类，否则就一个离群点。
	
	![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image025.png)
	
	图5 支持向量数据描述
	
	具体而言，假设训练数据的样本空间为![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image027.png)，压缩后的输出空间为![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image029.png)，使用![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image031.png)表示具有![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image033.png)层的神经网络，样本数据在输出空间的体量由半径![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image035.png)和中心![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image037.png)确定，可构建上述惩罚项![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image038.png)为![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image040.png)。将此惩罚项加入任意深度表征学习的目标函数中一起优化，可以使样本数据点紧密地映射到以![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image042.png)为中心的超球体内，达到最小化空间体量的目的。为求解对应的优化问题，可以采用交替固定/优化参数![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)和半径![](file:///C:/Users/ziiz/AppData/Local/Temp/msohtmlclip1/01/clip_image044.png)的方式以提高效率。除使用随机梯度下降法之外，还将尝试其它多种优化方法。
	
	以上方法可归于判别式模型，而**从生成式模型的角度出发，可借助生成对抗网络生成未知类别数据，将其纳入训练集中后以增强训练的方式逐步改进分类器，赋予其分辨未知数据的能力。**开放类别分类问题在此转化成如何生成未知类别数据的问题。一种可行的方案是，先用生成对抗网络的生成器产生新数据样本，再用判别器判断新样本是否属于已知类，并只保留下不是已知类的那些新样本作为增强数据，但这种方法会产生过多的远离原始已知数据的新样本。作为改善，可以要求生成器只在已知类别数据的边界附近生成新样本，由此生成的增强数据对训练分类器区分已知和未知数据更为有益。为达此目的，可将生成样本距已知样本集合的距离纳入生成器的优化目标之中。当因目标函数不可导或非凸而无法使用梯度下降等优化算法时，可使用诸如遗传算法等无梯度优化方法求解。

当下的研究表明，在所有场景下通用的开集分类器不具有可学习性。只有在不同任务场景的限制下，开集分类器是可学习的。因此，针对信息物理系统设计一种开集分类器是合理且必要的。
开集分类器的一般基于对闭集的改进。理论分析表明，分类器在分布内的性能越好，在开集识别问题上也会有更好的性能。因此开集分类器往往基于对现有方法的改进。一种可行的方法是对用于分类的神经网络模型，通过调整设计神经网络结构、损失函数和调整训练方式等，使得网络能够提取到有利于区分分布内和分布外样本的特征。
一种可行的方法是利用神经网络各层特征的特点，一般认为设网络深层的特征更有利于分类，而浅层特征更利于区分分布内和分布外的样本。可以利用神经网络各层特征训练单类支持向量机，给出样本的评估值来检测分布外样本。从语义偏移和协变量偏移的角度来看，深层特征包含更多的语义特征，据此设计的SEM分数能够检测语义偏移的分布外数据。
从样本的角度，得到少量的异常样本可以增强神经网络的泛化能力。在训练时引入异常值的做法称为异常值暴露，从已知的异常样本中获得启发，识别未知异常的样本。但是辅助训练用的分布外样本带来了损害分类器的决策边界的问题。一种可能的办法是筛选训练用的异常样本，选取语义信息更加丰富的样本，可以有效提高检测精度。